<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Adorable Black & White Kitty 3D Scene</title>
    <style>
        /* CSS Reset and Basic Styling */
        body, html {
            margin: 0;
            padding: 0;
            width: 100%;
            height: 100%;
            overflow: hidden;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #add8e6; /* Light blue fallback */
        }

        /* The 3D Container */
        #canvas-container {
            width: 100%;
            height: 100%;
            display: block;
            z-index: 1;
        }

        /* UI Overlay */
        #ui-layer {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none; /* Allow clicks to pass through to the 3D scene */
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            padding: 20px;
            box-sizing: border-box;
            z-index: 2;
        }

        header {
            color: #fff;
            text-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }

        h1 {
            margin: 0;
            font-size: 2rem;
            font-weight: 600;
        }

        p.subtitle {
            margin: 5px 0 0 0;
            font-size: 1rem;
            opacity: 0.9;
        }

        /* Reference Card */
        .inspiration-card {
            pointer-events: auto;
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            padding: 15px;
            border-radius: 12px;
            max-width: 300px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease;
        }

        .inspiration-card:hover {
            transform: translateY(-5px);
        }

        .inspiration-card h3 {
            margin-top: 0;
            font-size: 1rem;
            color: #333;
        }

        .inspiration-card img {
            width: 100%;
            border-radius: 8px;
            margin-bottom: 8px;
            object-fit: cover;
            border: 1px solid #eee;
        }

        .inspiration-card p {
            font-size: 0.85rem;
            color: #666;
            line-height: 1.4;
            margin: 0;
        }

        /* Instructions Overlay */
        .controls-hint {
            position: absolute;
            bottom: 20px;
            right: 20px;
            background: rgba(0, 0, 0, 0.5);
            color: white;
            padding: 10px 20px;
            border-radius: 20px;
            font-size: 0.9rem;
            pointer-events: none;
        }
    </style>
    
    <!-- Import Three.js and OrbitControls from CDN -->
    <script type="importmap">
        {
            "imports": {
                "three": "https://unpkg.com/three@0.160.0/build/three.module.js",
                "three/addons/": "https://unpkg.com/three@0.160.0/examples/jsm/"
            }
        }
    </script>
</head>
<body>

    <!-- Semantic UI Structure -->
    <main id="ui-layer">
        <header>
            <h1>Adorable Kitty</h1>
            <p class="subtitle">3D Scene Inspired by your Image</p>
        </header>

        <div style="flex-grow: 1;"></div>

        <div style="display: flex; justify-content: space-between; align-items: flex-end;">
            <article class="inspiration-card">
                <h3>Original Inspiration</h3>
                <!-- Using the provided image URL -->
                <img src="https://z-cdn-media.chatglm.cn/files/076fb2f5-143e-42e1-b020-cfdb5d7a954f.jpg?auth_key=1866595156-92a62779c6614a988fb65cb0f65346ad-0-08ca13865efc8bc5e726605adae224c7" alt="Black and white cat reference">
                <p>"A black and white cat sitting on a yellow surface with a light blue background. Bright green eyes and a quiet posture."</p>
            </article>

            <div class="controls-hint">
                üñ±Ô∏è Drag to Rotate ‚Ä¢ Scroll to Zoom
            </div>
        </div>
    </main>

    <!-- 3D Canvas Container -->
    <div id="canvas-container"></div>

    <!-- 3D Logic -->
    <script type="module">
        import * as THREE from 'three';
        import { OrbitControls } from 'three/addons/controls/OrbitControls.js';

        // --- Configuration ---
        const sceneConfig = {
            bgColor: 0xBFE6F5, // Light blue wall
            floorColor: 0xF4D03F, // Yellow surface
            catColorWhite: 0xFFFFFF,
            catColorBlack: 0x222222,
            eyeColor: 0x77DD77, // Light green
            shadowColor: 0x555555
        };

        // --- Global Variables ---
        let scene, camera, renderer, controls;
        let catGroup, tailBone;
        const clock = new THREE.Clock();

        // --- Initialization ---
        function init() {
            const container = document.getElementById('canvas-container');

            // 1. Scene Setup
            scene = new THREE.Scene();
            scene.background = new THREE.Color(sceneConfig.bgColor);
            // Add subtle fog to blend floor into background
            scene.fog = new THREE.Fog(sceneConfig.bgColor, 10, 50);

            // 2. Camera Setup
            camera = new THREE.PerspectiveCamera(45, window.innerWidth / window.innerHeight, 0.1, 100);
            camera.position.set(0, 5, 8);
            camera.lookAt(0, 1, 0);

            // 3. Renderer Setup
            renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
            renderer.setSize(window.innerWidth, window.innerHeight);
            renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2)); // Performance optimization
            renderer.shadowMap.enabled = true; // Enable shadows
            renderer.shadowMap.type = THREE.PCFSoftShadowMap;
            container.appendChild(renderer.domElement);

            // 4. Lighting
            setupLighting();

            // 5. Environment (Floor & Wall)
            setupEnvironment();

            // 6. The Cat (Procedural Generation)
            createCat();

            // 7. Controls
            controls = new OrbitControls(camera, renderer.domElement);
            controls.enableDamping = true;
            controls.dampingFactor = 0.05;
            controls.minDistance = 3;
            controls.maxDistance = 15;
            controls.maxPolarAngle = Math.PI / 2 - 0.05; // Prevent going below floor

            // 8. Event Listeners
            window.addEventListener('resize', onWindowResize);

            // 9. Start Animation Loop
            animate();
        }

        function setupLighting() {
            // Ambient light for general illumination
            const ambientLight = new THREE.AmbientLight(0xffffff, 0.6);
            scene.add(ambientLight);

            // Main Directional Light (Sun)
            const dirLight = new THREE.DirectionalLight(0xffffff, 1.2);
            dirLight.position.set(5, 10, 5);
            dirLight.castShadow = true;
            dirLight.shadow.mapSize.width = 2048;
            dirLight.shadow.mapSize.height = 2048;
            dirLight.shadow.bias = -0.0001;
            dirLight.shadow.camera.near = 0.5;
            dirLight.shadow.camera.far = 20;
            // Expand shadow camera area
            dirLight.shadow.camera.left = -5;
            dirLight.shadow.camera.right = 5;
            dirLight.shadow.camera.top = 5;
            dirLight.shadow.camera.bottom = -5;
            scene.add(dirLight);

            // Backlight/Rim light for outline definition
            const backLight = new THREE.DirectionalLight(0xBFE6F5, 0.5);
            backLight.position.set(-5, 5, -5);
            scene.add(backLight);
        }

        function setupEnvironment() {
            // Floor (Yellow Surface)
            const floorGeometry = new THREE.PlaneGeometry(50, 50);
            const floorMaterial = new THREE.MeshStandardMaterial({ 
                color: sceneConfig.floorColor,
                roughness: 0.8,
                metalness: 0.1
            });
            const floor = new THREE.Mesh(floorGeometry, floorMaterial);
            floor.rotation.x = -Math.PI / 2;
            floor.receiveShadow = true;
            scene.add(floor);

            // Optional: A backdrop plane if we want a distinct wall color, 
            // but scene.background works well for the "light blue wall" requirement.
        }

        // --- Procedural Cat Generation ---
        function createCat() {
            catGroup = new THREE.Group();

            // Materials
            const whiteMat = new THREE.MeshStandardMaterial({ color: sceneConfig.catColorWhite, roughness: 0.6 });
            const blackMat = new THREE.MeshStandardMaterial({ color: sceneConfig.catColorBlack, roughness: 0.6 });
            const eyeMat = new THREE.MeshStandardMaterial({ color: sceneConfig.eyeColor, roughness: 0.2, metalness: 0.3 });
            const noseMat = new THREE.MeshStandardMaterial({ color: 0xFFC0CB }); // Pink

            // 1. Body (White)
            const bodyGeo = new THREE.SphereGeometry(0.8, 32, 32);
            bodyGeo.scale(1, 0.8, 1.1); // Flatten and elongate slightly
            const body = new THREE.Mesh(bodyGeo, whiteMat);
            body.position.y = 0.8;
            body.castShadow = true;
            body.receiveShadow = true;
            catGroup.add(body);

            // 2. Head (White)
            const headGeo = new THREE.SphereGeometry(0.55, 32, 32);
            const head = new THREE.Mesh(headGeo, whiteMat);
            head.position.set(0, 1.3, 0.4);
            head.castShadow = true;
            catGroup.add(head);

            // 3. Black Mask (Face Pattern)
            // Creating a slightly deformed sphere to look like fur patches
            const maskGeo = new THREE.SphereGeometry(0.58, 32, 32);
            maskGeo.scale(0.9, 0.7, 0.5); // Flatten for face
            const mask = new THREE.Mesh(maskGeo, blackMat);
            mask.position.set(0, 1.3, 0.4);
            // Shift slightly forward so it covers half the face
            mask.position.z += 0.1; 
            catGroup.add(mask);

            // 4. Ears
            const earGeo = new THREE.ConeGeometry(0.18, 0.3, 32);
            earGeo.translate(0, 0.15, 0); // Pivot at bottom

            // Left Ear
            const leftEar = new THREE.Mesh(earGeo, blackMat);
            leftEar.position.set(-0.35, 1.8, 0.35);
            leftEar.rotation.set(-0.2, -0.2, 0);
            leftEar.rotation.z = -0.3; // Tilt out
            catGroup.add(leftEar);

            // Left Ear Inner (White)
            const innerEarGeo = new THREE.ConeGeometry(0.1, 0.2, 32);
            const leftInnerEar = new THREE.Mesh(innerEarGeo, whiteMat);
            leftInnerEar.position.set(-0.35, 1.8, 0.4);
            leftInnerEar.rotation.set(-0.2, -0.2, 0);
            leftInnerEar.rotation.z = -0.3;
            catGroup.add(leftInnerEar);

            // Right Ear
            const rightEar = new THREE.Mesh(earGeo, blackMat);
            rightEar.position.set(0.35, 1.8, 0.35);
            rightEar.rotation.set(-0.2, 0.2, 0);
            rightEar.rotation.z = 0.3; // Tilt out
            catGroup.add(rightEar);

            // Right Ear Inner (White)
            const rightInnerEar = new THREE.Mesh(innerEarGeo, whiteMat);
            rightInnerEar.position.set(0.35, 1.8, 0.4);
            rightInnerEar.rotation.set(-0.2, 0.2, 0);
            rightInnerEar.rotation.z = 0.3;
            catGroup.add(rightInnerEar);

            // 5. Eyes (Green)
            const eyeGeo = new THREE.SphereGeometry(0.1, 32, 32);
            
            // Left Eye
            const leftEye = new THREE.Mesh(eyeGeo, eyeMat);
            leftEye.position.set(-0.2, 1.35, 0.7);
            // Flatten the eye slightly
            leftEye.scale.set(1, 1.2, 0.5); 
            catGroup.add(leftEye);

            // Right Eye
            const rightEye = new THREE.Mesh(eyeGeo, eyeMat);
            rightEye.position.set(0.2, 1.35, 0.7);
            rightEye.scale.set(1, 1.2, 0.5);
            catGroup.add(rightEye);

            // Eye Highlights (White dots)
            const highlightGeo = new THREE.SphereGeometry(0.03, 16, 16);
            const highlightMat = new THREE.MeshBasicMaterial({ color: 0xffffff });
            
            const leftHighlight = new THREE.Mesh(highlightGeo, highlightMat);
            leftHighlight.position.set(-0.22, 1.38, 0.8);
            catGroup.add(leftHighlight);

            const rightHighlight = new THREE.Mesh(highlightGeo, highlightMat);
            rightHighlight.position.set(0.18, 1.38, 0.8);
            catGroup.add(rightHighlight);

            // 6. Nose (Pink)
            const noseGeo = new THREE.SphereGeometry(0.05, 16, 16);
            const nose = new THREE.Mesh(noseGeo, noseMat);
            nose.position.set(0, 1.2, 0.78);
            nose.scale.set(1.2, 0.8, 0.5);
            catGroup.add(nose);

            // 7. Tail (Black)
            // We construct a tail using a series of spheres or a curved cylinder
            // Let's use a simple curved tube made of a cylinder for animation
            const tailGeo = new THREE.CylinderGeometry(0.1, 0.15, 1.5, 16);
            tailGeo.translate(0, 0.75, 0); // Pivot at bottom
            tailGeo.rotateX(Math.PI / 4); // Initial curve up
            
            const tail = new THREE.Mesh(tailGeo, blackMat);
            tail.position.set(0, 0.8, -0.6);
            tail.castShadow = true;
            
            // Store reference to animate later
            tailBone = tail; 
            catGroup.add(tail);

            // 8. Paws (White tips)
            const pawGeo = new THREE.SphereGeometry(0.15, 16, 16);
            pawGeo.scale(1, 0.6, 1.2);
            
            const frontLeftPaw = new THREE.Mesh(pawGeo, whiteMat);
            frontLeftPaw.position.set(-0.35, 0.3, 0.5);
            catGroup.add(frontLeftPaw);

            const frontRightPaw = new THREE.Mesh(pawGeo, whiteMat);
            frontRightPaw.position.set(0.35, 0.3, 0.5);
            catGroup.add(frontRightPaw);

            // Add the entire cat to the scene
            scene.add(catGroup);
        }

        // --- Animation Loop ---
        function animate() {
            requestAnimationFrame(animate);

            const time = clock.getElapsedTime();

            // 1. Idle Animation: "Breathing"
            // Gently scale the Y axis of the body group
            const breathScale = 1 + Math.sin(time * 2) * 0.02;
            if(catGroup) {
                catGroup.scale.y = breathScale;
            }

            // 2. Tail Animation: Wags slowly
            if (tailBone) {
                // Rotate the tail around the X and Z axes slightly
                tailBone.rotation.z = Math.sin(time * 3) * 0.2; // Wag side to side
                tailBone.rotation.x = (Math.PI / 4) + Math.sin(time * 1.5) * 0.1; // Bob up/down
            }

            // Update controls and render
            controls.update();
            renderer.render(scene, camera);
        }

        // --- Resize Handler ---
        function onWindowResize() {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        }

        // Initialize the scene
        init();

    </script>
</body>
</html>